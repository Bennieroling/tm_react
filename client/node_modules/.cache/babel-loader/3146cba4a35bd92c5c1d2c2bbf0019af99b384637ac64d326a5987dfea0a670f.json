{"ast":null,"code":"import React,{useState,useEffect}from'react';import{historyApi}from'../services/api';import StatusIndicator from'../components/StatusIndicator';import'./GlobalHistoryView.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const GlobalHistoryView=()=>{const[historyData,setHistoryData]=useState([]);const[filteredData,setFilteredData]=useState([]);const[activeFilter,setActiveFilter]=useState(null);const[showOngoingOnly,setShowOngoingOnly]=useState(false);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[viewMode,setViewMode]=useState('country');// 'country' or 'phone'\nconst[searchTerm,setSearchTerm]=useState('');// Added new filters\nconst[countryFilter,setCountryFilter]=useState('');const[typeFilter,setTypeFilter]=useState('');// Filter settings\nconst[timeRange,setTimeRange]=useState('5d');const[startDate,setStartDate]=useState('');const[endDate,setEndDate]=useState('');const[showCustomDates,setShowCustomDates]=useState(false);useEffect(()=>{fetchHistoryData();},[timeRange,viewMode]);// Apply filters when filter states change or historyData updates\nuseEffect(()=>{// First filter out the \"green\" (online) events as we're only interested in issues\nlet filtered=historyData.filter(item=>item.status!=='green');// Apply status filter if active\nif(activeFilter){filtered=filtered.filter(item=>item.status===activeFilter);}// Apply search filter if in phone mode\nif(viewMode==='phone'&&searchTerm){const term=searchTerm.toLowerCase();filtered=filtered.filter(item=>item.number&&item.number.toLowerCase().includes(term));}// Apply country filter if selected\nif(countryFilter){const search=countryFilter.toLowerCase();filtered=filtered.filter(item=>item.country&&item.country.toLowerCase().includes(search));}// Apply type filter if selected\nif(typeFilter){filtered=filtered.filter(item=>item.type===typeFilter);}// Apply ongoing filter if active\nif(showOngoingOnly){filtered=filtered.filter(item=>item.status_end===null);}setFilteredData(filtered);},[activeFilter,showOngoingOnly,historyData,viewMode,searchTerm,countryFilter,typeFilter]);const fetchHistoryData=async()=>{try{setLoading(true);let params={timeRange};if(timeRange==='custom'&&startDate&&endDate){params.startDate=startDate;params.endDate=endDate;}let response;if(viewMode==='country'){response=await historyApi.getStatusHistory(params.timeRange,params.startDate,params.endDate);}else{response=await historyApi.getPhoneHistory(params.timeRange,params.startDate,params.endDate,searchTerm||null);}setHistoryData(response.data);setFilteredData(response.data);setLoading(false);// Log data for debugging\nconsole.log('Fetched history data:',response.data);console.log('Yellow items count:',response.data.filter(item=>item.status==='yellow').length);}catch(err){setError('Failed to fetch history data. Please try again later.');setLoading(false);console.error('Error fetching history data:',err);}};const handleFilterClick=status=>{if(activeFilter===status){// If clicking the same filter again, clear the filter\nsetActiveFilter(null);}else{setActiveFilter(status);}};const handleOngoingFilterClick=()=>{setShowOngoingOnly(!showOngoingOnly);// Don't reset status filter\n};const clearAllFilters=()=>{setActiveFilter(null);setShowOngoingOnly(false);setSearchTerm('');setCountryFilter('');setTypeFilter('');};// Get unique countries for filter dropdown\nconst getUniqueCountries=()=>{if(!historyData.length)return[];const countries=new Set();historyData.forEach(item=>{if(item.country)countries.add(item.country);});return Array.from(countries).sort();};// Get unique types for filter dropdown\nconst getUniqueTypes=()=>{if(!historyData.length)return[];const types=new Set();historyData.forEach(item=>{if(item.type)types.add(item.type);});return Array.from(types).sort();};// Get counts by status for issues only\nconst getStatusCounts=()=>{const counts={yellow:0,red:0,ongoing:0,total:0};historyData.forEach(item=>{if(item.status==='yellow'||item.status==='red'){counts[item.status]=(counts[item.status]||0)+1;counts.total++;// Count ongoing issues\nif(item.status_end===null){counts.ongoing++;}}});return counts;};// Format date to readable format\nconst formatDate=dateString=>{if(!dateString)return'Present';const date=new Date(dateString);return date.toLocaleString();};// Calculate duration between start and end times\nconst calculateDuration=(startDate,endDate)=>{if(!endDate)return'Ongoing';const start=new Date(startDate);const end=new Date(endDate);const durationMs=end-start;// Less than a minute\nif(durationMs<60000){return`${Math.floor(durationMs/1000)} seconds`;}// Less than an hour\nif(durationMs<3600000){return`${Math.floor(durationMs/60000)} minutes`;}// Less than a day\nif(durationMs<86400000){return`${Math.floor(durationMs/3600000)} hours`;}// More than a day\nreturn`${Math.floor(durationMs/86400000)} days`;};const handleTimeRangeChange=e=>{const newRange=e.target.value;setTimeRange(newRange);setShowCustomDates(newRange==='custom');};const handleCustomDateSubmit=e=>{e.preventDefault();fetchHistoryData();};// Group history data by country or phone number\nconst groupData=function(){let data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:filteredData;const grouped={};if(viewMode==='country'){data.forEach(item=>{if(!grouped[item.country]){grouped[item.country]=[];}grouped[item.country].push(item);});}else{data.forEach(item=>{if(!grouped[item.number]){grouped[item.number]=[];}grouped[item.number].push(item);});}return grouped;};// Add a title that shows the current filter status\nconst getFilterTitle=()=>{let title=\"\";if(activeFilter){title+=`${activeFilter==='yellow'?'Degraded':'Offline'} `;}else{title+=\"All \";}title+=\"Issues\";if(showOngoingOnly){title+=\" (Ongoing Only)\";}if(countryFilter){title+=` in ${countryFilter}`;}if(typeFilter){title+=` of type ${typeFilter}`;}return title;};const handleViewModeChange=mode=>{setViewMode(mode);// Reset filters when changing view mode\nsetActiveFilter(null);setShowOngoingOnly(false);setSearchTerm('');setCountryFilter('');setTypeFilter('');};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading history data...\"});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error});}const groupedData=groupData();return/*#__PURE__*/_jsxs(\"div\",{className:\"history-view\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Global Status History\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"view-mode-toggle\",children:[/*#__PURE__*/_jsx(\"button\",{className:`toggle-btn ${viewMode==='country'?'active':''}`,onClick:()=>handleViewModeChange('country'),children:\"View by Country\"}),/*#__PURE__*/_jsx(\"button\",{className:`toggle-btn ${viewMode==='phone'?'active':''}`,onClick:()=>handleViewModeChange('phone'),children:\"View by Phone Number\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-controls\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"time-range-selector\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"timeRange\",children:\"Time Range:\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"timeRange\",value:timeRange,onChange:handleTimeRangeChange,className:\"time-range-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"24h\",children:\"Last 24 Hours\"}),/*#__PURE__*/_jsx(\"option\",{value:\"48h\",children:\"Last 48 Hours\"}),/*#__PURE__*/_jsx(\"option\",{value:\"5d\",children:\"Last 5 Days\"}),/*#__PURE__*/_jsx(\"option\",{value:\"custom\",children:\"Custom Range\"})]})]}),showCustomDates&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleCustomDateSubmit,className:\"custom-date-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"date-input-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"startDate\",children:\"Start Date:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"datetime-local\",id:\"startDate\",value:startDate,onChange:e=>setStartDate(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"date-input-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"endDate\",children:\"End Date:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"datetime-local\",id:\"endDate\",value:endDate,onChange:e=>setEndDate(e.target.value),required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"apply-btn\",children:\"Apply\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"advanced-filters\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filter-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"countryFilter\",children:\"Country:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-field\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"countryFilter\",placeholder:\"Search for a country...\",value:countryFilter,onChange:e=>setCountryFilter(e.target.value),className:\"search-input\"}),countryFilter&&/*#__PURE__*/_jsx(\"button\",{className:\"clear-search-btn\",onClick:()=>setCountryFilter(''),children:\"\\xD7\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"typeFilter\",children:\"Type:\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"typeFilter\",value:typeFilter,onChange:e=>setTypeFilter(e.target.value),className:\"filter-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Types\"}),getUniqueTypes().map(type=>/*#__PURE__*/_jsx(\"option\",{value:type,children:type},type))]})]})]}),viewMode==='phone'&&/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search phone numbers...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"search-input\"}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchHistoryData,className:\"search-btn\",disabled:!searchTerm,children:\"Search\"})]}),(countryFilter||typeFilter||activeFilter||showOngoingOnly||searchTerm)&&/*#__PURE__*/_jsx(\"button\",{className:\"clear-filter-btn visible\",onClick:clearAllFilters,children:\"Clear All Filters\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"history-summary\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"summary-cards\",children:[/*#__PURE__*/_jsxs(\"div\",{className:`summary-card ${activeFilter==='red'?'active':''}`,onClick:()=>handleFilterClick('red'),children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Offline Issues\"}),/*#__PURE__*/_jsx(\"div\",{className:\"summary-count red\",children:getStatusCounts().red}),activeFilter==='red'&&/*#__PURE__*/_jsx(\"div\",{className:\"filter-badge\",children:\"Filtered\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:`summary-card ${activeFilter==='yellow'?'active':''}`,onClick:()=>handleFilterClick('yellow'),children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Degraded Issues\"}),/*#__PURE__*/_jsx(\"div\",{className:\"summary-count yellow\",children:getStatusCounts().yellow||0}),activeFilter==='yellow'&&/*#__PURE__*/_jsx(\"div\",{className:\"filter-badge\",children:\"Filtered\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-cards\",children:[/*#__PURE__*/_jsxs(\"div\",{className:`summary-card ${!activeFilter&&!showOngoingOnly?'active':''}`,onClick:clearAllFilters,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Total Issues\"}),/*#__PURE__*/_jsx(\"div\",{className:\"summary-count blue\",children:getStatusCounts().total}),!activeFilter&&!showOngoingOnly&&!countryFilter&&!typeFilter&&/*#__PURE__*/_jsx(\"div\",{className:\"filter-badge\",children:\"Showing All\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:`summary-card ${showOngoingOnly?'active':''}`,onClick:handleOngoingFilterClick,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Ongoing Issues\"}),/*#__PURE__*/_jsx(\"div\",{className:\"summary-count purple\",children:getStatusCounts().ongoing}),showOngoingOnly&&/*#__PURE__*/_jsx(\"div\",{className:\"filter-badge\",children:\"Filtered\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Issues Shown\"}),/*#__PURE__*/_jsx(\"div\",{className:\"info-value\",children:filteredData.length}),/*#__PURE__*/_jsx(\"div\",{className:\"info-detail\",children:activeFilter?`${activeFilter==='yellow'?'Degraded':'Offline'} incidents`:showOngoingOnly?'Ongoing incidents':'All incidents'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:viewMode==='country'?'Countries':'Phone Numbers'}),/*#__PURE__*/_jsx(\"div\",{className:\"info-value\",children:Object.keys(groupedData).length}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-detail\",children:[countryFilter?`In ${countryFilter}`:'All regions',typeFilter?`, type: ${typeFilter}`:'']})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"history-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[viewMode==='country'?'Countries':'Phone Numbers',\" - \",getFilterTitle()]}),(activeFilter||showOngoingOnly||searchTerm||countryFilter||typeFilter)&&/*#__PURE__*/_jsx(\"button\",{className:\"clear-filter visible\",onClick:clearAllFilters,children:\"Clear All Filters\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"history-list\",children:[Object.entries(groupedData).map(_ref=>{let[key,events]=_ref;return/*#__PURE__*/_jsxs(\"div\",{className:viewMode==='country'?\"country-history-card\":\"phone-history-card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:key}),/*#__PURE__*/_jsxs(\"table\",{className:\"history-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Started\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Ended\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Duration\"}),viewMode==='phone'&&/*#__PURE__*/_jsx(\"th\",{children:\"Country\"}),viewMode==='phone'&&/*#__PURE__*/_jsx(\"th\",{children:\"Type\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:events.map(event=>/*#__PURE__*/_jsxs(\"tr\",{className:`status-${event.status}`,children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(StatusIndicator,{status:event.status})}),/*#__PURE__*/_jsx(\"td\",{children:formatDate(event.status_start)}),/*#__PURE__*/_jsx(\"td\",{children:formatDate(event.status_end)}),/*#__PURE__*/_jsx(\"td\",{children:calculateDuration(event.status_start,event.status_end)}),viewMode==='phone'&&/*#__PURE__*/_jsx(\"td\",{children:event.country}),viewMode==='phone'&&/*#__PURE__*/_jsx(\"td\",{children:event.type||'N/A'})]},event.id))})]})]},key);}),Object.keys(groupedData).length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"no-results\",children:[\"No \",viewMode==='country'?'countries':'phone numbers',\" match the current filters.\",/*#__PURE__*/_jsx(\"button\",{onClick:clearAllFilters,className:\"clear-link\",children:\"Clear filters\"})]})]})]});};export default GlobalHistoryView;","map":{"version":3,"names":["React","useState","useEffect","historyApi","StatusIndicator","jsx","_jsx","jsxs","_jsxs","GlobalHistoryView","historyData","setHistoryData","filteredData","setFilteredData","activeFilter","setActiveFilter","showOngoingOnly","setShowOngoingOnly","loading","setLoading","error","setError","viewMode","setViewMode","searchTerm","setSearchTerm","countryFilter","setCountryFilter","typeFilter","setTypeFilter","timeRange","setTimeRange","startDate","setStartDate","endDate","setEndDate","showCustomDates","setShowCustomDates","fetchHistoryData","filtered","filter","item","status","term","toLowerCase","number","includes","search","country","type","status_end","params","response","getStatusHistory","getPhoneHistory","data","console","log","length","err","handleFilterClick","handleOngoingFilterClick","clearAllFilters","getUniqueCountries","countries","Set","forEach","add","Array","from","sort","getUniqueTypes","types","getStatusCounts","counts","yellow","red","ongoing","total","formatDate","dateString","date","Date","toLocaleString","calculateDuration","start","end","durationMs","Math","floor","handleTimeRangeChange","e","newRange","target","value","handleCustomDateSubmit","preventDefault","groupData","arguments","undefined","grouped","push","getFilterTitle","title","handleViewModeChange","mode","className","children","groupedData","onClick","htmlFor","id","onChange","onSubmit","required","placeholder","map","disabled","Object","keys","entries","_ref","key","events","event","status_start"],"sources":["/Users/benvandijk/Downloads/monitoring/TM/client/src/views/GlobalHistoryView.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { historyApi } from '../services/api';\nimport StatusIndicator from '../components/StatusIndicator';\nimport './GlobalHistoryView.css';\n\nconst GlobalHistoryView = () => {\n  const [historyData, setHistoryData] = useState([]);\n  const [filteredData, setFilteredData] = useState([]);\n  const [activeFilter, setActiveFilter] = useState(null);\n  const [showOngoingOnly, setShowOngoingOnly] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [viewMode, setViewMode] = useState('country');  // 'country' or 'phone'\n  const [searchTerm, setSearchTerm] = useState('');\n  \n  // Added new filters\n  const [countryFilter, setCountryFilter] = useState('');\n  const [typeFilter, setTypeFilter] = useState('');\n  \n  // Filter settings\n  const [timeRange, setTimeRange] = useState('5d');\n  const [startDate, setStartDate] = useState('');\n  const [endDate, setEndDate] = useState('');\n  const [showCustomDates, setShowCustomDates] = useState(false);\n\n  useEffect(() => {\n    fetchHistoryData();\n  }, [timeRange, viewMode]);\n\n  // Apply filters when filter states change or historyData updates\n  useEffect(() => {\n    // First filter out the \"green\" (online) events as we're only interested in issues\n    let filtered = historyData.filter(item => item.status !== 'green');\n    \n    // Apply status filter if active\n    if (activeFilter) {\n      filtered = filtered.filter(item => item.status === activeFilter);\n    }\n    \n    // Apply search filter if in phone mode\n    if (viewMode === 'phone' && searchTerm) {\n      const term = searchTerm.toLowerCase();\n      filtered = filtered.filter(item => \n        item.number && item.number.toLowerCase().includes(term)\n      );\n    }\n    \n    // Apply country filter if selected\n    if (countryFilter) {\n      const search = countryFilter.toLowerCase();\n      filtered = filtered.filter(item => \n        item.country && item.country.toLowerCase().includes(search)\n      );\n    }\n    \n    // Apply type filter if selected\n    if (typeFilter) {\n      filtered = filtered.filter(item => item.type === typeFilter);\n    }\n    \n    // Apply ongoing filter if active\n    if (showOngoingOnly) {\n      filtered = filtered.filter(item => item.status_end === null);\n    }\n    \n    setFilteredData(filtered);\n  }, [activeFilter, showOngoingOnly, historyData, viewMode, searchTerm, countryFilter, typeFilter]);\n\n  const fetchHistoryData = async () => {\n    try {\n      setLoading(true);\n      \n      let params = { timeRange };\n      if (timeRange === 'custom' && startDate && endDate) {\n        params.startDate = startDate;\n        params.endDate = endDate;\n      }\n      \n      let response;\n      \n      if (viewMode === 'country') {\n        response = await historyApi.getStatusHistory(\n          params.timeRange,\n          params.startDate,\n          params.endDate\n        );\n      } else {\n        response = await historyApi.getPhoneHistory(\n          params.timeRange,\n          params.startDate,\n          params.endDate,\n          searchTerm || null\n        );\n      }\n      \n      setHistoryData(response.data);\n      setFilteredData(response.data);\n      setLoading(false);\n      \n      // Log data for debugging\n      console.log('Fetched history data:', response.data);\n      console.log('Yellow items count:', response.data.filter(item => item.status === 'yellow').length);\n    } catch (err) {\n      setError('Failed to fetch history data. Please try again later.');\n      setLoading(false);\n      console.error('Error fetching history data:', err);\n    }\n  };\n\n  const handleFilterClick = (status) => {\n    if (activeFilter === status) {\n      // If clicking the same filter again, clear the filter\n      setActiveFilter(null);\n    } else {\n      setActiveFilter(status);\n    }\n  };\n  \n  const handleOngoingFilterClick = () => {\n    setShowOngoingOnly(!showOngoingOnly);\n    // Don't reset status filter\n  };\n  \n  const clearAllFilters = () => {\n    setActiveFilter(null);\n    setShowOngoingOnly(false);\n    setSearchTerm('');\n    setCountryFilter('');\n    setTypeFilter('');\n  };\n  \n  // Get unique countries for filter dropdown\n  const getUniqueCountries = () => {\n    if (!historyData.length) return [];\n    \n    const countries = new Set();\n    historyData.forEach(item => {\n      if (item.country) countries.add(item.country);\n    });\n    \n    return Array.from(countries).sort();\n  };\n  \n  // Get unique types for filter dropdown\n  const getUniqueTypes = () => {\n    if (!historyData.length) return [];\n    \n    const types = new Set();\n    historyData.forEach(item => {\n      if (item.type) types.add(item.type);\n    });\n    \n    return Array.from(types).sort();\n  };\n  \n  // Get counts by status for issues only\n  const getStatusCounts = () => {\n    const counts = {\n      yellow: 0,\n      red: 0,\n      ongoing: 0,\n      total: 0\n    };\n    \n    historyData.forEach(item => {\n      if (item.status === 'yellow' || item.status === 'red') {\n        counts[item.status] = (counts[item.status] || 0) + 1;\n        counts.total++;\n        \n        // Count ongoing issues\n        if (item.status_end === null) {\n          counts.ongoing++;\n        }\n      }\n    });\n    \n    return counts;\n  };\n\n  // Format date to readable format\n  const formatDate = (dateString) => {\n    if (!dateString) return 'Present';\n    const date = new Date(dateString);\n    return date.toLocaleString();\n  };\n\n  // Calculate duration between start and end times\n  const calculateDuration = (startDate, endDate) => {\n    if (!endDate) return 'Ongoing';\n    \n    const start = new Date(startDate);\n    const end = new Date(endDate);\n    const durationMs = end - start;\n    \n    // Less than a minute\n    if (durationMs < 60000) {\n      return `${Math.floor(durationMs / 1000)} seconds`;\n    }\n    // Less than an hour\n    if (durationMs < 3600000) {\n      return `${Math.floor(durationMs / 60000)} minutes`;\n    }\n    // Less than a day\n    if (durationMs < 86400000) {\n      return `${Math.floor(durationMs / 3600000)} hours`;\n    }\n    // More than a day\n    return `${Math.floor(durationMs / 86400000)} days`;\n  };\n\n  const handleTimeRangeChange = (e) => {\n    const newRange = e.target.value;\n    setTimeRange(newRange);\n    setShowCustomDates(newRange === 'custom');\n  };\n\n  const handleCustomDateSubmit = (e) => {\n    e.preventDefault();\n    fetchHistoryData();\n  };\n\n  // Group history data by country or phone number\n  const groupData = (data = filteredData) => {\n    const grouped = {};\n    \n    if (viewMode === 'country') {\n      data.forEach(item => {\n        if (!grouped[item.country]) {\n          grouped[item.country] = [];\n        }\n        grouped[item.country].push(item);\n      });\n    } else {\n      data.forEach(item => {\n        if (!grouped[item.number]) {\n          grouped[item.number] = [];\n        }\n        grouped[item.number].push(item);\n      });\n    }\n    \n    return grouped;\n  };\n\n  // Add a title that shows the current filter status\n  const getFilterTitle = () => {\n    let title = \"\";\n    \n    if (activeFilter) {\n      title += `${activeFilter === 'yellow' ? 'Degraded' : 'Offline'} `;\n    } else {\n      title += \"All \";\n    }\n    \n    title += \"Issues\";\n    \n    if (showOngoingOnly) {\n      title += \" (Ongoing Only)\";\n    }\n    \n    if (countryFilter) {\n      title += ` in ${countryFilter}`;\n    }\n    \n    if (typeFilter) {\n      title += ` of type ${typeFilter}`;\n    }\n    \n    return title;\n  };\n\n  const handleViewModeChange = (mode) => {\n    setViewMode(mode);\n    // Reset filters when changing view mode\n    setActiveFilter(null);\n    setShowOngoingOnly(false);\n    setSearchTerm('');\n    setCountryFilter('');\n    setTypeFilter('');\n  };\n\n  if (loading) {\n    return <div className=\"loading\">Loading history data...</div>;\n  }\n\n  if (error) {\n    return <div className=\"error\">{error}</div>;\n  }\n\n  const groupedData = groupData();\n  \n  return (\n    <div className=\"history-view\">\n      <h1>Global Status History</h1>\n      \n      <div className=\"view-mode-toggle\">\n        <button \n          className={`toggle-btn ${viewMode === 'country' ? 'active' : ''}`}\n          onClick={() => handleViewModeChange('country')}\n        >\n          View by Country\n        </button>\n        <button \n          className={`toggle-btn ${viewMode === 'phone' ? 'active' : ''}`}\n          onClick={() => handleViewModeChange('phone')}\n        >\n          View by Phone Number\n        </button>\n      </div>\n      \n      <div className=\"filter-controls\">\n        <div className=\"time-range-selector\">\n          <label htmlFor=\"timeRange\">Time Range:</label>\n          <select \n            id=\"timeRange\" \n            value={timeRange} \n            onChange={handleTimeRangeChange}\n            className=\"time-range-select\"\n          >\n            <option value=\"24h\">Last 24 Hours</option>\n            <option value=\"48h\">Last 48 Hours</option>\n            <option value=\"5d\">Last 5 Days</option>\n            <option value=\"custom\">Custom Range</option>\n          </select>\n        </div>\n        \n        {showCustomDates && (\n          <form onSubmit={handleCustomDateSubmit} className=\"custom-date-form\">\n            <div className=\"date-input-group\">\n              <label htmlFor=\"startDate\">Start Date:</label>\n              <input \n                type=\"datetime-local\" \n                id=\"startDate\" \n                value={startDate} \n                onChange={(e) => setStartDate(e.target.value)}\n                required\n              />\n            </div>\n            \n            <div className=\"date-input-group\">\n              <label htmlFor=\"endDate\">End Date:</label>\n              <input \n                type=\"datetime-local\" \n                id=\"endDate\" \n                value={endDate} \n                onChange={(e) => setEndDate(e.target.value)}\n                required\n              />\n            </div>\n            \n            <button type=\"submit\" className=\"apply-btn\">Apply</button>\n          </form>\n        )}\n        \n        <div className=\"advanced-filters\">\n          <div className=\"filter-group\">\n            <label htmlFor=\"countryFilter\">Country:</label>\n            <div className=\"search-field\">\n              <input\n                type=\"text\"\n                id=\"countryFilter\"\n                placeholder=\"Search for a country...\"\n                value={countryFilter}\n                onChange={(e) => setCountryFilter(e.target.value)}\n                className=\"search-input\"\n              />\n              {countryFilter && (\n                <button \n                  className=\"clear-search-btn\"\n                  onClick={() => setCountryFilter('')}\n                >\n                  ×\n                </button>\n              )}\n            </div>\n          </div>\n          \n          <div className=\"filter-group\">\n            <label htmlFor=\"typeFilter\">Type:</label>\n            <select\n              id=\"typeFilter\"\n              value={typeFilter}\n              onChange={(e) => setTypeFilter(e.target.value)}\n              className=\"filter-select\"\n            >\n              <option value=\"\">All Types</option>\n              {getUniqueTypes().map(type => (\n                <option key={type} value={type}>{type}</option>\n              ))}\n            </select>\n          </div>\n        </div>\n        \n        {viewMode === 'phone' && (\n          <div className=\"search-container\">\n            <input\n              type=\"text\"\n              placeholder=\"Search phone numbers...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"search-input\"\n            />\n            <button \n              onClick={fetchHistoryData} \n              className=\"search-btn\"\n              disabled={!searchTerm}\n            >\n              Search\n            </button>\n          </div>\n        )}\n        \n        {(countryFilter || typeFilter || activeFilter || showOngoingOnly || searchTerm) && (\n          <button\n            className=\"clear-filter-btn visible\"\n            onClick={clearAllFilters}\n          >\n            Clear All Filters\n          </button>\n        )}\n      </div>\n      \n      <div className=\"history-summary\">\n        <div className=\"summary-cards\">\n          <div \n            className={`summary-card ${activeFilter === 'red' ? 'active' : ''}`}\n            onClick={() => handleFilterClick('red')}\n          >\n            <h3>Offline Issues</h3>\n            <div className=\"summary-count red\">{getStatusCounts().red}</div>\n            {activeFilter === 'red' && <div className=\"filter-badge\">Filtered</div>}\n          </div>\n          \n          <div \n            className={`summary-card ${activeFilter === 'yellow' ? 'active' : ''}`}\n            onClick={() => handleFilterClick('yellow')}\n          >\n            <h3>Degraded Issues</h3>\n            <div className=\"summary-count yellow\">{getStatusCounts().yellow || 0}</div>\n            {activeFilter === 'yellow' && <div className=\"filter-badge\">Filtered</div>}\n          </div>\n        </div>\n        \n        <div className=\"summary-cards\">\n          <div \n            className={`summary-card ${!activeFilter && !showOngoingOnly ? 'active' : ''}`}\n            onClick={clearAllFilters}\n          >\n            <h3>Total Issues</h3>\n            <div className=\"summary-count blue\">{getStatusCounts().total}</div>\n            {!activeFilter && !showOngoingOnly && !countryFilter && !typeFilter && <div className=\"filter-badge\">Showing All</div>}\n          </div>\n          \n          <div \n            className={`summary-card ${showOngoingOnly ? 'active' : ''}`}\n            onClick={handleOngoingFilterClick}\n          >\n            <h3>Ongoing Issues</h3>\n            <div className=\"summary-count purple\">{getStatusCounts().ongoing}</div>\n            {showOngoingOnly && <div className=\"filter-badge\">Filtered</div>}\n          </div>\n        </div>\n        \n        <div className=\"summary-info\">\n          <div className=\"info-card\">\n            <h3>Issues Shown</h3>\n            <div className=\"info-value\">{filteredData.length}</div>\n            <div className=\"info-detail\">\n              {activeFilter \n                ? `${activeFilter === 'yellow' ? 'Degraded' : 'Offline'} incidents` \n                : (showOngoingOnly ? 'Ongoing incidents' : 'All incidents')}\n            </div>\n          </div>\n          <div className=\"info-card\">\n            <h3>{viewMode === 'country' ? 'Countries' : 'Phone Numbers'}</h3>\n            <div className=\"info-value\">{Object.keys(groupedData).length}</div>\n            <div className=\"info-detail\">\n              {countryFilter ? `In ${countryFilter}` : 'All regions'}\n              {typeFilter ? `, type: ${typeFilter}` : ''}\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <div className=\"history-header\">\n        <h2>{viewMode === 'country' ? 'Countries' : 'Phone Numbers'} - {getFilterTitle()}</h2>\n        {(activeFilter || showOngoingOnly || searchTerm || countryFilter || typeFilter) && (\n          <button \n            className=\"clear-filter visible\"\n            onClick={clearAllFilters}\n          >\n            Clear All Filters\n          </button>\n        )}\n      </div>\n      \n      <div className=\"history-list\">\n        {Object.entries(groupedData).map(([key, events]) => (\n          <div key={key} className={viewMode === 'country' ? \"country-history-card\" : \"phone-history-card\"}>\n            <h2>{key}</h2>\n            <table className=\"history-table\">\n              <thead>\n                <tr>\n                  <th>Status</th>\n                  <th>Started</th>\n                  <th>Ended</th>\n                  <th>Duration</th>\n                  {viewMode === 'phone' && <th>Country</th>}\n                  {viewMode === 'phone' && <th>Type</th>}\n                </tr>\n              </thead>\n              <tbody>\n                {events.map((event) => (\n                  <tr key={event.id} className={`status-${event.status}`}>\n                    <td>\n                      <StatusIndicator status={event.status} />\n                    </td>\n                    <td>{formatDate(event.status_start)}</td>\n                    <td>{formatDate(event.status_end)}</td>\n                    <td>{calculateDuration(event.status_start, event.status_end)}</td>\n                    {viewMode === 'phone' && <td>{event.country}</td>}\n                    {viewMode === 'phone' && <td>{event.type || 'N/A'}</td>}\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        ))}\n        \n        {Object.keys(groupedData).length === 0 && (\n          <div className=\"no-results\">\n            No {viewMode === 'country' ? 'countries' : 'phone numbers'} match the current filters.\n            <button onClick={clearAllFilters} className=\"clear-link\">Clear filters</button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default GlobalHistoryView;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}